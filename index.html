<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ScoreHub Pro</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.2/papaparse.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800;900&family=Roboto+Mono:wght@700&display=swap" rel="stylesheet">
    <style>
        :root { --accent: #00ff85; --bg: #0b0e11; --card: #161b22; --border: #30363d; }
        body { background: var(--bg); color: #fff; font-family: 'Inter', sans-serif; letter-spacing: -0.02em; overflow-x: hidden; }
        .no-scrollbar::-webkit-scrollbar { display: none; }
        
        header { background: rgba(11, 14, 17, 0.95); backdrop-blur: 12px; border-bottom: 1px solid var(--border); position: fixed; top: 0; width: 100%; max-width: 448px; z-index: 100; }
        
        .date-nav { display: flex; align-items: center; justify-content: space-between; padding: 12px 16px; background: var(--card); border-radius: 12px; margin: 16px; }
        .date-nav button { background: transparent; border: none; color: #8b949e; font-size: 20px; cursor: pointer; padding: 8px; }
        .date-nav button:hover { color: var(--accent); }
        .date-display { font-weight: 800; font-size: 15px; cursor: pointer; }
        
        .filter-pills { display: flex; gap: 12px; padding: 12px 16px; overflow-x: auto; }
        .filter-pill { background: var(--card); border: 1px solid var(--border); padding: 8px 16px; border-radius: 20px; font-size: 12px; font-weight: 700; white-space: nowrap; cursor: pointer; }
        .filter-pill.active { background: var(--accent); color: #000; border-color: var(--accent); }
        
        .league-section { margin: 16px 0; }
        .league-header { padding: 12px 16px; font-size: 13px; font-weight: 900; color: #8b949e; display: flex; align-items: center; gap: 8px; cursor: pointer; }
        .league-flag { width: 20px; height: 20px; border-radius: 4px; }
        
        .match-card { background: var(--card); border: 1px solid var(--border); border-radius: 12px; padding: 16px; margin: 0 16px 8px; display: flex; justify-content: space-between; align-items: center; }
        .team-row { display: flex; align-items: center; gap: 12px; padding: 6px 0; }
        .team-logo { width: 28px; height: 28px; object-fit: contain; }
        .team-name { font-size: 14px; font-weight: 700; flex: 1; }
        .score { font-size: 16px; font-weight: 900; font-family: 'Roboto Mono', monospace; width: 24px; text-align: center; }
        .match-time { font-size: 13px; font-weight: 700; color: #8b949e; text-align: center; width: 70px; }
        .match-time.live { color: #22c55e; font-weight: 900; }
        .match-time.ft { color: #ef4444; font-weight: 900; }
        
        .nav-bottom { position: fixed; bottom: 0; width: 100%; max-width: 448px; background: #161b22; border-top: 1px solid var(--border); display: flex; justify-content: space-around; padding: 12px 0; z-index: 100; }
        .nav-btn { font-size: 10px; font-weight: 800; color: #8b949e; cursor: pointer; text-transform: uppercase; display: flex; flex-direction: column; align-items: center; gap: 4px; }
        .nav-btn.active { color: var(--accent); }
        
        .wdl-column { font-family: 'Roboto Mono', monospace; font-weight: 700; color: #d1d5db; letter-spacing: -0.05em; }
        .qualify-indicator { width: 4px; height: 24px; border-radius: 2px; margin-right: 10px; }
        .active-league { background: var(--accent) !important; color: #000 !important; }
        .collapsed .matches-container { display: none; }
        .chevron { transition: transform 0.2s; }
        .collapsed .chevron { transform: rotate(-90deg); }
        
        .loading-msg { padding: 20px; text-align: center; color: #8b949e; font-size: 12px; font-weight: 700; }
    </style>
</head>
<body class="max-w-md mx-auto pb-32">

    <header>
        <div class="p-4 flex justify-between items-center">
            <h1 class="text-xl font-black italic tracking-tighter uppercase">Score<span class="text-[#00ff85]">Hub</span></h1>
            <div id="sync-status" class="flex items-center gap-2">
                <span id="sync-label" class="text-[9px] font-bold text-zinc-500 uppercase">Live Hub</span>
                <div class="w-2 h-2 rounded-full bg-green-500 animate-pulse"></div>
            </div>
        </div>
    </header>

    <main class="mt-20">
        <div id="tab-matches">
            <div class="date-nav">
                <button onclick="changeDate(-1)">‚Äπ</button>
                <div class="date-display" id="currentDate" onclick="resetToToday()">Loading...</div>
                <button onclick="changeDate(1)">‚Ä∫</button>
            </div>
            
            <div class="filter-pills no-scrollbar">
                <div class="filter-pill active" onclick="filterLeague('all')">All</div>
                <div class="filter-pill" onclick="filterLeague('PREM')">Premier League</div>
                <div class="filter-pill" onclick="filterLeague('LALIGA')">La Liga</div>
                <div class="filter-pill" onclick="filterLeague('MLS')">MLS</div>
            </div>

            <div id="matchesList" class="loading-msg">Loading matches...</div>
        </div>

        <div id="tab-standings" class="hidden">
            <div class="flex gap-2 px-4 py-4 overflow-x-auto no-scrollbar">
                <button id="btn-PREM" onclick="renderTable('PREM')" class="league-btn text-[10px] font-black bg-zinc-800 px-5 py-2.5 rounded-full whitespace-nowrap transition-all">PREMIER LEAGUE</button>
                <button id="btn-LALIGA" onclick="renderTable('LALIGA')" class="league-btn text-[10px] font-black bg-zinc-800 px-5 py-2.5 rounded-full whitespace-nowrap transition-all">LA LIGA</button>
                <button id="btn-MLS" onclick="renderTable('MLS')" class="league-btn text-[10px] font-black bg-zinc-800 px-5 py-2.5 rounded-full whitespace-nowrap transition-all">MLS</button>
            </div>
            <div class="px-2 overflow-x-auto">
                <div class="bg-zinc-900/50 rounded-xl border border-zinc-800 min-w-[460px]">
                    <table class="w-full text-left text-[11px]">
                        <thead>
                            <tr id="tableHead" class="uppercase bg-zinc-800/50"></tr>
                        </thead>
                        <tbody id="standingsContent"></tbody>
                    </table>
                </div>
            </div>
            <div id="tableLegend" class="mt-6 px-4 flex flex-wrap gap-4"></div>
        </div>

        <div id="tab-stats" class="hidden p-10 text-center text-zinc-500 font-bold uppercase text-xs">
            Stats Coming Soon...
        </div>
    </main>

    <nav class="nav-bottom">
        <div onclick="switchTab('matches')" id="nav-matches" class="nav-btn active"><i>‚öΩ</i>Matches</div>
        <div onclick="switchTab('standings')" id="nav-standings" class="nav-btn"><i>üèÜ</i>Standings</div>
        <div onclick="switchTab('stats')" id="nav-stats" class="nav-btn"><i>üìà</i>Stats</div>
    </nav>

    <script>
        const SCHEDULE_URLS = {
            PREM: 'https://docs.google.com/spreadsheets/d/e/2PACX-1vRGHDcX_hIIzPlyqTZhiySqRNTQho5XFkyRaHqHa0tiPDC3D7zO_b3Mud054IRLzPKaHV1cERaYj3w0/pub?gid=0&single=true&output=csv',
            LALIGA: 'https://docs.google.com/spreadsheets/d/e/2PACX-1vRGHDcX_hIIzPlyqTZhiySqRNTQho5XFkyRaHqHa0tiPDC3D7zO_b3Mud054IRLzPKaHV1cERaYj3w0/pub?gid=1737121812&single=true&output=csv',
            MLS: 'https://docs.google.com/spreadsheets/d/e/2PACX-1vT03H3Or-8DCxNZkAnIdhVuwJsej-AEuo6VgZO3pG4WsBYt1HPxCLN0CsGa5P33XghzKltG5AiymB4q/pub?gid=0&single=true&output=csv'
        };

        const STANDINGS_URLS = {
            PREM: 'https://docs.google.com/spreadsheets/d/e/2PACX-1vRGHDcX_hIIzPlyqTZhiySqRNTQho5XFkyRaHqHa0tiPDC3D7zO_b3Mud054IRLzPKaHV1cERaYj3w0/pub?gid=935978435&single=true&output=csv',
            LALIGA: 'https://docs.google.com/spreadsheets/d/e/2PACX-1vRGHDcX_hIIzPlyqTZhiySqRNTQho5XFkyRaHqHa0tiPDC3D7zO_b3Mud054IRLzPKaHV1cERaYj3w0/pub?gid=886605383&single=true&output=csv',
            MLS: 'https://docs.google.com/spreadsheets/d/e/2PACX-1vT03H3Or-8DCxNZkAnIdhVuwJsej-AEuo6VgZO3pG4WsBYt1HPxCLN0CsGa5P33XghzKltG5AiymB4q/pub?gid=1177278404&single=true&output=csv'
        };

        const LOGOS = {
            "Liverpool": "https://resources.premierleague.com/premierleague25/badges-alt/14.svg",
            "Newcastle": "https://resources.premierleague.com/premierleague25/badges-alt/4.svg",
            "Chelsea": "https://resources.premierleague.com/premierleague25/badges-alt/8.svg",
            "Aston Villa": "https://resources.premierleague.com/premierleague25/badges-alt/7.svg",
            "Man City": "https://resources.premierleague.com/premierleague25/badges-alt/43.svg",
            "Man United": "https://resources.premierleague.com/premierleague25/badges-alt/1.svg",
            "Arsenal": "https://resources.premierleague.com/premierleague25/badges-alt/3.svg",
            "Southampton": "https://upload.wikimedia.org/wikipedia/en/thumb/c/c9/FC_Southampton.svg/1051px-FC_Southampton.svg.png",
            "Bournemouth": "https://resources.premierleague.com/premierleague25/badges-alt/91.svg",
            "Leeds": "https://resources.premierleague.com/premierleague25/badges-alt/2.svg",
            "Brighton": "https://resources.premierleague.com/premierleague25/badges-alt/36.svg",
            "West Ham": "https://resources.premierleague.com/premierleague25/badges-alt/21.svg",
            "Brentford": "https://resources.premierleague.com/premierleague25/badges-alt/94.svg",
            "Tottenham": "https://resources.premierleague.com/premierleague25/badges-alt/6.svg",
            "Crystal Palace": "https://resources.premierleague.com/premierleague25/badges-alt/31.svg",
            "Leicester": "https://upload.wikimedia.org/wikipedia/en/thumb/2/2d/Leicester_City_crest.svg/1200px-Leicester_City_crest.svg.png",
            "Nott'm Forest": "https://resources.premierleague.com/premierleague25/badges-alt/17.svg",
            "Nottingham": "https://resources.premierleague.com/premierleague25/badges-alt/17.svg",
            "Sunderland": "https://resources.premierleague.com/premierleague25/badges-alt/56.svg",
            "Burnley": "https://resources.premierleague.com/premierleague25/badges-alt/90.svg",
            "Wolves": "https://resources.premierleague.com/premierleague25/badges-alt/39.svg",
            "Fulham": "https://resources.premierleague.com/premierleague25/badges-alt/54.svg",
            "Everton": "https://resources.premierleague.com/premierleague25/badges-alt/11.svg",
            "Ipswich": "https://resources.premierleague.com/premierleague25/badges-alt/40.svg",
            "Barcelona": "https://ssl.gstatic.com/onebox/media/sports/logos/paYnEE8hcrP96neHRNofhQ_48x48.png",
            "Real Madrid": "https://ssl.gstatic.com/onebox/media/sports/logos/Th4fAVAZeCJWRcKoLW7koA_48x48.png",
            "Sevilla": "https://ssl.gstatic.com/onebox/media/sports/logos/hCTs5EX3WjCMC5Jl3QE4Rw_48x48.png",
            "Real Sociedad": "https://ssl.gstatic.com/onebox/media/sports/logos/w8tb1aeBfVZIj9tZXf7eZg_48x48.png",
            "Girona": "https://ssl.gstatic.com/onebox/media/sports/logos/sHiSmLm_rA0BOC5MfrNt8A_48x48.png",
            "Atletico Madrid": "https://ssl.gstatic.com/onebox/media/sports/logos/pEqmA7CL-VRo4Llq3rwIPA_48x48.png",
            "Athletic Bilbao": "https://ssl.gstatic.com/onebox/media/sports/logos/OSL_5Zm6kYPP1J17Bo5uDA_48x48.png",
            "Athletic": "https://ssl.gstatic.com/onebox/media/sports/logos/OSL_5Zm6kYPP1J17Bo5uDA_48x48.png",
            "Elche": "https://ssl.gstatic.com/onebox/media/sports/logos/uyyqqxLIYT_lQIXRyMI_RA_48x48.png",
            "Osasuna": "https://ssl.gstatic.com/onebox/media/sports/logos/pk-hNCNpGM_JDoHHvLVF-Q_48x48.png",
            "Villarreal": "https://ssl.gstatic.com/onebox/media/sports/logos/WKH7Ak5cYD6Qm1EEqXzmVw_48x48.png",
            "Levante": "https://ssl.gstatic.com/onebox/media/sports/logos/SQB-jlVosxVV1Ce79FhbOA_48x48.png",
            "Las Palmas": "https://upload.wikimedia.org/wikipedia/sco/thumb/2/20/UD_Las_Palmas_logo.svg/1188px-UD_Las_Palmas_logo.svg.png",
            "Mallorca": "https://ssl.gstatic.com/onebox/media/sports/logos/Ss21P4CUmigjrEtcoapjVg_48x48.png",
            "Espanyol": "https://ssl.gstatic.com/onebox/media/sports/logos/TKitIqelDyN6M-kYt4Uc0g_48x48.png",
            "Valencia": "https://ssl.gstatic.com/onebox/media/sports/logos/QPbjvDwI_0Wuu4tCS2O6uw_48x48.png",
            "Real Betis": "https://ssl.gstatic.com/onebox/media/sports/logos/XDClkrMKtkm3UTP2YKN6oQ_48x48.png",
            "Betis": "https://ssl.gstatic.com/onebox/media/sports/logos/XDClkrMKtkm3UTP2YKN6oQ_48x48.png",
            "Real Oviedo": "https://ssl.gstatic.com/onebox/media/sports/logos/2hbZVQulcYqiPFXkWDkB_g_48x48.png",
            "Celta Vigo": "https://ssl.gstatic.com/onebox/media/sports/logos/wpdhixHP_sloegfP0UlwAw_48x48.png",
            "Celta": "https://ssl.gstatic.com/onebox/media/sports/logos/wpdhixHP_sloegfP0UlwAw_48x48.png",
            "Rayo Vallecano": "https://ssl.gstatic.com/onebox/media/sports/logos/i5LifmxEVIl0sbvIysiyhw_48x48.png",
            "Alaves": "https://ssl.gstatic.com/onebox/media/sports/logos/RUcTOeFcBc7q7uku1nR_iQ_48x48.png",
            "Getafe": "https://ssl.gstatic.com/onebox/media/sports/logos/jqll6zSd9TZofPk5CR_B1w_48x48.png",
            "Leganes": "https://ssl.gstatic.com/onebox/media/sports/logos/c0FJxye3t46n10AUIEK0cA_48x48.png",
            "Valladolid": "https://ssl.gstatic.com/onebox/media/sports/logos/SN1BSVY-lrUj6Y_ZJsOa5Q_48x48.png",
            "Miami": "https://images.mlssoccer.com/image/upload/t_club_logo_medium/v1747755405/assets/logos/mls-clubs/Club_Logo-Miami_tyqe64.png",
            "LAFC": "https://images.mlssoccer.com/image/upload/t_club_logo_medium/v174775309/assets/logos/mls-clubs/Club_Logo-LAFC_djrhru.png",
            "Atlanta": "https://images.mlssoccer.com/image/upload/t_club_logo_medium/v1747499879/assets/logos/mls-clubs/Club_Logo-Atlanta_jtk7ku.png",
            "Toronto": "https://images.mlssoccer.com/image/upload/t_club_logo_medium/v1748265251/assets/logos/mls-clubs/Club_Logo-Toronto_vz6hao.png",
            "San Diego": "https://images.mlssoccer.com/image/upload/t_club_logo_medium/v1748261519/assets/logos/mls-clubs/Club_Logo-San_Diego_nwpyul.png",
            "Orlando": "https://images.mlssoccer.com/image/upload/t_club_logo_medium/v1747769281/assets/logos/mls-clubs/Club_Logo-Orlando_ryyn7a.png",
            "Houston": "https://images.mlssoccer.com/image/upload/t_club_logo_medium/v1747500939/assets/logos/mls-clubs/Club_Logo-Houston_oifm77.png",
            "Charlotte": "https://images.mlssoccer.com/image/upload/t_club_logo_medium/v1747500045/assets/logos/mls-clubs/Club_Logo-Charlotte_p7sznf.png",
            "Salt Lake": "https://images.mlssoccer.com/image/upload/t_club_logo_medium/v1747776403/assets/logos/mls-clubs/Club_Logo-Salt_Lake_City_hpvde5.png",
            "Vancouver": "https://images.mlssoccer.com/image/upload/t_club_logo_medium/v1748265547/assets/logos/mls-clubs/Club_Logo-Vancouver_ao9phl.png",
            "LA Galaxy": "https://images.mlssoccer.com/image/upload/t_club_logo_medium/v1747755165/assets/logos/mls-clubs/Club_Logo-LA_Galaxy_fg0wjp.png",
            "Seattle": "https://images.mlssoccer.com/image/upload/t_club_logo_medium/v1748265125/assets/logos/mls-clubs/Club_Logo-Seattle_e6jk2x.png",
            "Columbus": "https://images.mlssoccer.com/image/upload/t_club_logo_medium/v1747500414/assets/logos/mls-clubs/Club_Logo-Columbus_light_z3eq8l.png",
            "Montreal": "https://images.mlssoccer.com/image/upload/t_club_logo_medium/v1747755806/assets/logos/mls-clubs/Club_Logo-Montreal_beeqnh.png",
            "San Jose": "https://images.mlssoccer.com/image/upload/t_club_logo_medium/v1748262048/assets/logos/mls-clubs/Club_Logo-San_Jose_opzlmo.png",
            "NY Red Bulls": "https://images.mlssoccer.com/image/upload/t_club_logo_medium/v1747771783/assets/logos/mls-clubs/Club_Logo-RBNY_dwawvt.png",
            "Colorado": "https://images.mlssoccer.com/image/upload/t_club_logo_medium/v1747500322/assets/logos/mls-clubs/Club_Logo-Colorado_n5kpss.png",
            "New England": "https://images.mlssoccer.com/image/upload/t_club_logo_medium/v1766020750/assets/NE_Logo_PRI_FC_RGB_480x480_fdx2us.png",
            "Minnesota": "https://images.mlssoccer.com/image/upload/t_club_logo_medium/v1747754826/assets/logos/mls-clubs/Club_Logo-Minnesota_ftweor.png",
            "Chicago": "https://images.mlssoccer.com/image/upload/t_club_logo_medium/v1747500178/assets/logos/mls-clubs/Club_Logo-Chicago_jm2yev.png",
            "Portland": "https://images.mlssoccer.com/image/upload/t_club_logo_medium/v1747771943/assets/logos/mls-clubs/Club_Logo-Portland_jrihbf.png",
            "Nashville": "https://images.mlssoccer.com/image/upload/t_club_logo_medium/v1747754937/assets/logos/mls-clubs/Club_Logo-Nashville_owcihx.png",
            "Austin": "https://images.mlssoccer.com/image/upload/t_club_logo_medium/v1747500115/assets/logos/mls-clubs/Club_Logo-Austin_u0tpqe.png",
            "FC Dallas": "https://images.mlssoccer.com/image/upload/t_club_logo_medium/v1747500587/assets/logos/mls-clubs/Club_Logo-Dallas_oxywdo.png",
            "Dallas": "https://images.mlssoccer.com/image/upload/t_club_logo_medium/v1747500587/assets/logos/mls-clubs/Club_Logo-Dallas_oxywdo.png",
            "St Louis": "https://images.mlssoccer.com/image/upload/t_club_logo_medium/v1748265198/assets/logos/mls-clubs/Club_Logo-St._Louis_oikgm5.png",
            "NYCFC": "https://images.mlssoccer.com/image/upload/t_club_logo_medium/v1747755975/assets/logos/mls-clubs/Club_Logo-NYC_vhnmkv.png",
            "Philadelphia": "https://images.mlssoccer.com/image/upload/t_club_logo_medium/v1747772038/assets/logos/mls-clubs/Club_Logo-Philadelphia_l8yj9f.png",
            "Sporting KC": "https://images.mlssoccer.com/image/upload/t_club_logo_medium/v1748265350/assets/logos/mls-clubs/Club_Logo-Sporting_Kansas_City_rrkzdb.png",
            "DC United": "https://images.mlssoccer.com/image/upload/t_club_logo_medium/v1747500514/assets/logos/mls-clubs/Club_Logo-DC_United_igj4qy.png",
            "Cincinnati": "https://images.mlssoccer.com/image/upload/t_club_logo_medium/v1747500252/assets/logos/mls-clubs/Club_Logo-Cincinatti_ohmgcp.png"
        };

        const LEAGUE_FLAGS = { PREM: 'üè¥', LALIGA: 'üá™üá∏', MLS: 'üá∫üá∏' };
        const LEAGUE_NAMES = { PREM: 'England - Premier League', LALIGA: 'Spain - LaLiga', MLS: 'USA - MLS' };

        let currentDate = new Date('2025-08-15');
        let allMatches = [];
        let currentFilter = 'all';
        let allDates = [];

        function getLogo(team) {
            if (!team) return "https://via.placeholder.com/28?text=?";
            team = team.trim();
            for (let key in LOGOS) {
                if (team.toLowerCase().includes(key.toLowerCase()) || key.toLowerCase().includes(team.toLowerCase())) {
                    return LOGOS[key];
                }
            }
            return "https://via.placeholder.com/28?text=" + team.charAt(0);
        }

        function parseDate(dateStr) {
            if (!dateStr) return null;
            dateStr = dateStr.trim();
            let match = dateStr.match(/^(\d{1,2})\/(\d{1,2})\/(\d{4})$/);
            if (match) return new Date(match[3], match[1] - 1, match[2]);
            match = dateStr.match(/^(\d{4})-(\d{2})-(\d{2})$/);
            if (match) return new Date(match[1], match[2] - 1, match[3]);
            const parsed = new Date(dateStr);
            if (!isNaN(parsed.getTime())) return parsed;
            return null;
        }

        function formatDate(date) {
            const days = ['Sunday', 'Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday'];
            const months = ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'];
            return `${days[date.getDay()]}, ${months[date.getMonth()]} ${date.getDate()}`;
        }

        function isSameDay(d1, d2) {
            return d1.getFullYear() === d2.getFullYear() &&
                   d1.getMonth() === d2.getMonth() &&
                   d1.getDate() === d2.getDate();
        }

        async function loadAllMatches() {
            allMatches = [];
            let loadedCount = 0;

            for (let league of ['PREM','LALIGA','MLS']) {
                await new Promise(resolve => {
                    Papa.parse(SCHEDULE_URLS[league], {
                        download: true,
                        header: true,
                        skipEmptyLines: 'greedy',
                        complete: res => {
                            res.data.forEach(row => {
                                const dateStr = row.Date || row.date || row.DATE || row['Match Date'] || '';
                                const home = (row.Home || row.home || row.HOME || row['Home Team'] || '').trim();
                                const away = (row.Away || row.away || row.AWAY || row['Away Team'] || '').trim();
                                const homeScore = row['Home Score'] || row['home score'] || row.HomeScore || row['Home Goals'] || '';
                                const awayScore = row['Away Score'] || row['away score'] || row.AwayScore || row['Away Goals'] || '';
                                const time = row.Time || row.time || row.TIME || '';
                                const status = (row.Status || 'SCHEDULED').toUpperCase();
                                const minute = row.Minute || '';

                                const date = parseDate(dateStr);

                                if (date && home && away) {
                                    allMatches.push({league,date,home,away,homeScore,awayScore,time,status,minute});
                                    loadedCount++;
                                }
                            });
                            resolve();
                        },
                        error: err => { console.error(err); resolve(); }
                    });
                });
            }

            allMatches.sort((a,b) => a.date-b.date);
            const dateSet = new Set();
            allMatches.forEach(m=>dateSet.add(`${m.date.getFullYear()}-${m.date.getMonth()}-${m.date.getDate()}`));
            allDates = Array.from(dateSet).sort();
            if(allMatches.length>0) currentDate=new Date(allMatches[0].date);
            renderMatches();
        }

        function renderMatches() {
            const list = document.getElementById('matchesList');
            document.getElementById('currentDate').textContent = formatDate(currentDate);
            const dayMatches = allMatches.filter(m=>isSameDay(m.date,currentDate) && (currentFilter==='all'||m.league===currentFilter));

            if(dayMatches.length===0) { list.innerHTML='<div class="loading-msg">No matches found.</div>'; return; }

            const leagues = {};
            dayMatches.forEach(m=> { if(!leagues[m.league]) leagues[m.league]=[]; leagues[m.league].push(m); });

            let html='';
            for(let league of Object.keys(leagues)){
                html+=`<div class="league-section collapsed">
                    <div class="league-header" onclick="this.parentElement.classList.toggle('collapsed')">
                        <span class="chevron">‚ñ∂</span> ${LEAGUE_FLAGS[league]} ${LEAGUE_NAMES[league]}
                    </div>
                    <div class="matches-container">`;

                leagues[league].forEach(m=>{
                    const displayTime = m.time;
                    let timeHtml='';
                    if(m.status==='LIVE') timeHtml=`<div class="match-time live">${m.minute}'</div>`;
                    else if(m.status==='HT') timeHtml=`<div class="match-time live">HT</div>`;
                    else if(m.status==='FT') timeHtml=`<div class="match-time ft">FT</div>`;
                    else timeHtml=`<div class="match-time">${displayTime}</div>`;

                    html+=`<div class="match-card">
                        <div class="team-row">
                            <img class="team-logo" src="${getLogo(m.home)}">
                            <div class="team-name">${m.home}</div>
                            <div class="score">${m.homeScore||'-'}</div>
                        </div>
                        ${timeHtml}
                        <div class="team-row">
                            <img class="team-logo" src="${getLogo(m.away)}">
                            <div class="team-name">${m.away}</div>
                            <div class="score">${m.awayScore||'-'}</div>
                        </div>
                    </div>`;
                });

                html+='</div></div>';
            }

            list.innerHTML = html;
        }

        function changeDate(offset) {
            currentDate.setDate(currentDate.getDate()+offset);
            renderMatches();
        }

        function resetToToday() { 
            currentDate = new Date();
            renderMatches();
        }

        function filterLeague(league){
            currentFilter=league;
            document.querySelectorAll('.filter-pill').forEach(p=>p.classList.remove('active'));
            document.querySelectorAll('.filter-pill').forEach(p=>{if(p.textContent.replace(/\s/g,'').toLowerCase().includes(league.toLowerCase())) p.classList.add('active');});
            renderMatches();
        }

        function switchTab(tab){
            document.querySelectorAll('main > div').forEach(d=>d.classList.add('hidden'));
            document.getElementById('tab-'+tab).classList.remove('hidden');
            document.querySelectorAll('.nav-btn').forEach(b=>b.classList.remove('active'));
            document.getElementById('nav-'+tab).classList.add('active');
        }

        loadAllMatches();
        setInterval(loadAllMatches,30000); // auto-refresh every 30s
    </script>
</body>
</html>
